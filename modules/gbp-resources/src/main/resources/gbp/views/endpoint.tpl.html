<div ng-controller="endpointCtrl" ng-init="init()">

    <h2 class="text-center">Endpoint</h2> 

    <div ng-include src="view_path+'parts/crud.tpl.html'"></div>

    <section class="formWrapper clearfix" ng-show="endpointView">
        <form name="endpointForm" novalidate="novalidate">
            <i class="icon-remove align-right" ng-click="close()"></i>

            <div class="rowWrapper">
                <label class="block basicLabel"><span>Network containment:</span></label>
                <input class="form-control" type="text" ng-model="newEndpointObj['network-containment']"/>
            </div>

            <div class="rowWrapper">
                <label class="block basicLabel"><span>Endpoint group:</span></label>
                <select class="form-control" ng-model="newEndpointObj['endpoint-group']"  ng-options="c.id as getDisplayLabel(c, epg.labels) for c in epg.options">
                    <option>--</option>
                </select>
            </div>

            <div class="rowWrapper">
                <label class="basicLabel"><span>Endpoint groups:</span></label>
                <button class="btn btn-primary btn-slim" ng-click="addNewLeafListEl('endpoint-groups')"><i class="icon-plus"></i></button>

                <div ng-repeat="epGroups in newEndpointObj['endpoint-groups'] track by $index">
                    <div class="selectWrapper col-md-10">
                        <div class="rowWrapper">
                            <select class="form-control" ng-model="epGroups"  ng-change="updateLeafListEl($index, epGroups, 'endpoint-groups')" ng-options="c.id as getDisplayLabel(c, epg.labels) for c in epg.options">
                                <option>--</option>
                            </select>
                        </div>
                    </div>
                    <button class="btn btn-danger col-md-2" ng-click="deleteNewLeafListEl($index,'endpoint-groups')"><i class="icon-remove"></i></button>
                </div>
            </div>

            <div class="rowWrapper">
                <label class="basicLabel"><span>Condition:</span></label>
                <button class="btn btn-primary btn-slim" ng-click="addNewLeafListEl('condition')"><i class="icon-plus"></i></button>

                <div ng-repeat="condition in newEndpointObj['condition'] track by $index">
                    <div class="selectWrapper col-md-10">
                        <div class="rowWrapper">
                            <input class="form-control" type="text" ng-model="condition" ng-change="updateLeafListEl($index, condition, 'condition')"/>
                        </div>
                    </div>
                    <button class="btn btn-danger col-md-2" ng-click="deleteNewLeafListEl($index,'condition')"><i class="icon-remove"></i></button>
                </div>
            </div>

            <div class="rowWrapper">
                <label class="block basicLabel"><span>L2 context:</span>
                    <i class="icon-exclamation-sign red" tooltip="Required field" ng-show="endpointForm.l2context.$error.required"></i>
                </label>
                <select class="form-control" ng-model="newEndpointObj['l2-context']" name="l2context" ng-required="true" ng-options="c.id as getDisplayLabel(c, l2context.labels) for c in l2context.options">
                    <option>--</option>
                </select>
            </div>

            <div class="rowWrapper">
                <label class="block basicLabel"><span>MAC Address:</span>
                    <i class="icon-exclamation-sign red" tooltip="Invalid pattern" ng-show="endpointForm.macAddress.$error.pattern"></i>
                </label>
                <input class="form-control" type="text" name="macAddress" ng-model="newEndpointObj['mac-address']" ng-pattern="/^([0-9a-fA-F]{2}(:[0-9a-fA-F]{2}){5})$/"/>
            </div>

            <div class="rowWrapper">
                <label class="basicLabel"><span>L3 Address:</span></label>
                <button class="btn btn-primary btn-slim" ng-click="addNewL3address()"><i class="icon-plus"></i></button>

                <div ng-repeat="l3address in newEndpointObj['l3-address'] track by $index">
                    <div class="separator col-md-11">
                        <div class="inner-separator"></div>
                    </div>
                    <div class="selectWrapper col-md-10">
                        <div class="rowWrapper">
                            <label class="block basicLabel"><span>L3 Context:</span></label>
                            <select class="form-control" ng-model="l3address['l3-context']" ng-options="c.id as getDisplayLabel(c, l3context.labels) for c in l3context.options">
                                <option>--</option>
                            </select>
                        </div>

                        <div class="rowWrapper">
                            <label class="block basicLabel"><span>IP Address:</span>
                                <i class="icon-exclamation-sign red" tooltip="Invalid pattern" ng-show="endpointForm.ipAddress.$error.pattern"></i>
                            </label>
                            <input class="form-control" type="text" ng-model="l3address['ip-address']" name="ipAddress" ng-pattern="/^(([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])$/"/>
                        </div>
                    </div>
                    <button class="btn btn-danger col-md-2 btn-list" ng-click="deleteNewL3address($index)"><i class="icon-remove"></i></button>
                </div>
            </div>

            <button class="btn btn-primary col-md-12" ng-click="save()">Save</button>
        </form>
    </section>

    <button class="btn btn-primary col-md-12" ng-click="toggleExpanded('endpoints')">Back</button>

</div>